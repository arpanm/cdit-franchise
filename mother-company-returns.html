<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Return Requests - Mother Company Admin - CDIT Franchise Management Platform</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/responsive.css">
    <link rel="stylesheet" href="css/common-dashboard.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css">
</head>
<body>
    <div class="d-flex">
        <!-- Left Sidebar -->
        <div class="sidebar bg-dark text-white p-3 admin-sidebar">
            <h5 class="mb-4 py-2 border-bottom">Return Management</h5>
            <button class="toggle-btn" onclick="toggleSidebar()">
                <i class="bi bi-chevron-left"></i>
            </button>
            <ul class="nav flex-column">
                <li class="nav-item mb-2">
                    <a href="mother-company-dashboard.html" class="nav-link text-white active">
                        <i class="bi bi-speedometer2 me-2"></i> Performance
                    </a>
                </li>
                <li class="nav-item mb-2">
                    <a href="mother-company-service.html" class="nav-link text-white">
                        <i class="bi bi-tools me-2"></i> Service
                    </a>
                </li>
                <li class="nav-item mb-2">
                    <a href="mother-company-franchise.html" class="nav-link text-white">
                        <i class="bi bi-building me-2"></i> Franchises
                    </a>
                </li>
                <li class="nav-item mb-2">
                    <a href="mother-company-orders.html" class="nav-link text-white">
                        <i class="bi bi-cart3 me-2"></i> Order Management
                    </a>
                </li>
                <li class="nav-item mb-2">
                    <a href="mother-company-returns.html" class="nav-link text-white">
                        <i class="bi bi-arrow-return-left me-2"></i>
                        <i class="bi bi-box-seam me-2"></i> Return Management
                    </a>
                </li>
                <li class="nav-item mb-2">
                    <a href="mother-company-credits.html" class="nav-link text-white">
                        <i class="bi bi-credit-card me-2"></i> Credit Management
                    </a>
                </li>
                <li class="nav-item mb-2">
                    <a href="mother-company-commission.html" class="nav-link text-white">
                        <i class="bi bi-percent me-2"></i> Commission Management
                    </a>
                </li>
                <li class="nav-item mb-2">
                    <a href="mother-company-dispute.html" class="nav-link text-white">
                        <i class="bi bi-exclamation-triangle me-2"></i> Dispute Management
                    </a>
                </li>
                <li class="nav-item mb-2">
                    <a href="mother-company-schemes.html" class="nav-link text-white">
                        <i class="bi bi-gift me-2"></i> Scheme Management
                    </a>
                </li>
                <li class="nav-item mb-2">
                    <a href="mother-company-allocation-rules.html" class="nav-link text-white">
                        <i class="bi bi-gift me-2"></i> Service Allocation Rule 
                    </a>
                </li>
                <li class="nav-item mb-2">
                    <a href="#" class="nav-link text-white">
                        <i class="bi bi-gear me-2"></i> Settings
                    </a>
                </li>
                <li class="nav-item mt-auto">
                    <a href="#" class="nav-link text-white" onclick="logout()">
                        <i class="bi bi-box-arrow-right me-2"></i> Logout
                    </a>
                </li>
            </ul>
        </div>

        <!-- Main Content -->
        <div class="main-content p-4 w-100">
            <h2>Return Requests Management</h2>
            
            <!-- Summary Cards -->
            <div class="row mb-4">
                <div class="col-md-4">
                    <div class="card bg-primary text-white">
                        <div class="card-body">
                            <h6 class="card-title">Pending Requests</h6>
                            <h2 class="mb-0" id="pendingCount">0</h2>
                            <small>Awaiting Review</small>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card bg-success text-white">
                        <div class="card-body">
                            <h6 class="card-title">Approved Returns</h6>
                            <h2 class="mb-0" id="approvedCount">0</h2>
                            <small>Last 30 Days</small>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card bg-danger text-white">
                        <div class="card-body">
                            <h6 class="card-title">Rejected Returns</h6>
                            <h2 class="mb-0" id="rejectedCount">0</h2>
                            <small>Last 30 Days</small>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Filters -->
            <div class="card mb-4">
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-3">
                            <select class="form-select" id="statusFilter">
                                <option value="">All Status</option>
                                <option value="pending">Pending</option>
                                <option value="approved">Approved</option>
                                <option value="rejected">Rejected</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <select class="form-select" id="locationFilter">
                                <option value="">All Locations</option>
                                <option value="mumbai">Mumbai</option>
                                <option value="delhi">Delhi</option>
                                <option value="bangalore">Bangalore</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <div class="input-group">
                                <input type="text" class="form-control" id="dateRangeFilter" placeholder="Select Date Range" readonly>
                                <span class="input-group-text"><i class="bi bi-calendar-range"></i></span>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="input-group">
                                <input type="text" class="form-control" id="searchFilter" placeholder="Search...">
                                <span class="input-group-text"><i class="bi bi-search"></i></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Return Requests Table -->
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">Return Requests</h5>
                    <button class="btn btn-success btn-sm">Export to Excel</button>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover" id="returnRequestsTable">
                            <thead>
                                <tr>
                                    <th>Request ID</th>
                                    <th>Franchise</th>
                                    <th>Product Details</th>
                                    <th>Return Reason</th>
                                    <th>Request Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="returnRequestsTableBody">
                                <!-- Table content will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Return Details Modal -->
    <div class="modal fade" id="returnDetailsModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Return Request Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <h6>Request Information</h6>
                            <p><strong>Request ID:</strong> <span id="modalRequestId"></span></p>
                            <p><strong>Status:</strong> <span id="modalStatus"></span></p>
                            <p><strong>Request Date:</strong> <span id="modalRequestDate"></span></p>
                        </div>
                        <div class="col-md-6">
                            <h6>Franchise Information</h6>
                            <p><strong>Name:</strong> <span id="modalFranchiseName"></span></p>
                            <p><strong>Location:</strong> <span id="modalLocation"></span></p>
                            <p><strong>Contact:</strong> <span id="modalContact"></span></p>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-12">
                            <h6>Product Details</h6>
                            <p><strong>Product:</strong> <span id="modalProduct"></span></p>
                            <p><strong>Serial Number:</strong> <span id="modalSerialNumber"></span></p>
                            <p><strong>Purchase Date:</strong> <span id="modalPurchaseDate"></span></p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <h6>Return Details</h6>
                            <p><strong>Reason:</strong> <span id="modalReason"></span></p>
                            <p><strong>Description:</strong> <span id="modalDescription"></span></p>
                        </div>
                    </div>
                </div>
                <div class="modal-footer" id="modalActions">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-danger" onclick="handleReturnAction('reject')">Reject Return</button>
                    <button type="button" class="btn btn-success" onclick="handleReturnAction('approve')">Approve Return</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Courier Details Modal -->
    <div class="modal fade" id="courierDetailsModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Enter Courier Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="courierDetailsForm">
                        <div class="mb-3">
                            <label for="courierId" class="form-label">Courier ID</label>
                            <input type="text" class="form-control" id="courierId" required>
                        </div>
                        <div class="mb-3">
                            <label for="returnOrderId" class="form-label">Return Order ID</label>
                            <input type="text" class="form-control" id="returnOrderId" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-success" onclick="submitCourierDetails()">Submit</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Rejection Reason Modal -->
    <div class="modal fade" id="rejectionReasonModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Enter Rejection Reason</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="rejectionReasonForm">
                        <div class="mb-3">
                            <label for="rejectionReason" class="form-label">Reason for Rejection</label>
                            <select class="form-select" id="rejectionReason" required>
                                <option value="" selected disabled>Select a reason</option>
                                <option value="Invalid Return Request">Invalid Return Request</option>
                                <option value="Product Not Eligible">Product Not Eligible</option>
                                <option value="Warranty Expired">Warranty Expired</option>
                                <option value="Incomplete Information">Incomplete Information</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-danger" onclick="submitRejectionReason()">Submit</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/jquery/latest/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
    <script src="js/login.js"></script>
    <script src="js/return-requests.js"></script>
</body>
</html>